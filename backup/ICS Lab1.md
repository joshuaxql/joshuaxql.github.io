# 完整代码
```
0011 0000 0000 0000    ; start at address x3000
0001 000 000 1 00000   ; ADD R0, R0, #0
0000 010 000000010     ; BRz ELSE
0001 000 001 1 00000   ; ADD R0, R1, #0
0000 111 000000001     ; BRnzp DONE
0001 000 010 1 00000   ; ELSE: ADD R0, R2, #0
1111 0000 0010 0101    ; DONE: HALT
```
# 代码讲解
## 逐条指令详细分析
### 指令1：设置条件码
```
0001 000 000 1 00000   ; ADD R0, R0, #0
```
- **操作码**: `0001` (ADD)
- **目标寄存器**: `000` (R0)
- **源寄存器**: `000` (R0)  
- **立即数模式**: `1`
- **立即数值**: `00000` (0)
- **功能**: 将 R0 的值与 0 相加，结果存回 R0
- **关键作用**: 虽然 R0 的值不变，但会根据其值设置条件码标志位(NZP)

### 指令2：条件分支
```
0000 010 000000010   ; BRz ELSE
```
- **操作码**: `0000` (BR)
- **条件码**: `010` (Z - 为零时分支)
- **PC偏移量**: `000000010` (2)
- **功能**: 如果上条指令设置的条件码显示为零(Z=1)，则跳转到 PC+2+2 = PC+4
- **计算**: 当前PC=x3001，目标地址=x3001+1+2=x3004

### 指令3：选择 val1
```
0001 000 001 1 00000   ; ADD R0, R1, #0
```
- **操作码**: `0001` (ADD)
- **目标寄存器**: `000` (R0)
- **源寄存器**: `001` (R1)
- **立即数模式**: `1`
- **立即数值**: `00000` (0)
- **功能**: 将 R1(val1) 的值复制到 R0
- **执行条件**: 当 cond=1 时执行此指令

### 指令4：无条件跳转
```
0000 111 000000001   ; BRnzp DONE
```
- **操作码**: `0000` (BR)
- **条件码**: `111` (nzp - 无条件分支)
- **PC偏移量**: `000000001` (1)
- **功能**: 无条件跳转到 PC+2+1 = PC+3
- **计算**: 当前PC=x3003，目标地址=x3003+1+1=x3005
- **目的**: 跳过 ELSE 部分，避免重复执行

### 指令5：选择 val2
```
0001 000 010 1 00000   ; ADD R0, R2, #0
```
- **操作码**: `0001` (ADD)
- **目标寄存器**: `000` (R0)
- **源寄存器**: `010` (R2)
- **立即数模式**: `1`
- **立即数值**: `00000` (0)
- **功能**: 将 R2(val2) 的值复制到 R0
- **执行条件**: 当 cond=0 时执行此指令

### 指令6：程序终止
```
1111 000000100101   ; TRAP x25
```
- **操作码**: `1111` (TRAP)
- **陷阱向量**: `000000100101` (x25)
- **功能**: 调用系统陷阱服务程序，x25 对应 HALT 指令
- **作用**: 正常终止程序执行

## 内存地址布局

| 地址 | 指令 | 标签 | 功能 |
|------|------|------|------|
| x3000 | ADD R0, R0, #0 | - | 设置条件码 |
| x3001 | BRz ELSE | - | 条件分支 |
| x3002 | ADD R0, R1, #0 | - | 选择 val1 |
| x3003 | BRnzp DONE | - | 跳过 ELSE |
| x3004 | ADD R0, R2, #0 | ELSE | 选择 val2 |
| x3005 | TRAP x25 | DONE | 程序终止 |

## 执行路径分析

### 情况1: cond = 1 (R0 = 1)
```
x3000: ADD R0, R0, #0  // R0=1, 设置P(正数)标志
x3001: BRz ELSE        // Z=0, 不跳转，继续执行
x3002: ADD R0, R1, #0  // R0 ← R1 (选择val1)
x3003: BRnzp DONE      // 无条件跳转到x3005
x3005: TRAP x25        // 程序终止
```
**结果**: R0 = val1

### 情况2: cond = 0 (R0 = 0)
```
x3000: ADD R0, R0, #0  // R0=0, 设置Z(零)标志
x3001: BRz ELSE        // Z=1, 跳转到x3004
x3004: ADD R0, R2, #0  // R0 ← R2 (选择val2)
x3005: TRAP x25        // 程序终止
```
**结果**: R0 = val2